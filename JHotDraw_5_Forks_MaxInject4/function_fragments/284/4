    public void serialize( Document doc )
        throws IOException
    {
        reset();
        prepare();
        serializeNode( doc ,X1);
        serializePreRoot();
        _printer.flush();
        if ( _printer.getException() != null )
            throw _printer.getException();
    }
